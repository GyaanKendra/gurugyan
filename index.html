<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Success Stories</title>
  <style>
    /* Student View Card */
    body {font-family: Arial, sans-serif; margin:0; background:#f4f6f9;}

    .success-stories {background:#d4eaff; padding:50px 15px;}
    .success-stories h2 {text-align:center; font-size:2rem; margin-bottom:25px; color:#222;}

    .success-box {display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:20px; max-width:1000px; margin:0 auto;}

    .success-card {
      background:#fff;
      padding:18px;
      border-radius:12px;
      box-shadow:0 2px 8px rgba(0,0,0,0.1);
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      position:relative;
    }
    .success-card p {font-size:0.95rem; color:#555; text-align:justify;}
    .success-card span.name {font-size:0.85rem; color:#20a4f3; font-weight:600; margin-top:10px; display:block; text-align:right;}

    /* Views */
    .views {display:flex; align-items:center; gap:4px; font-size:0.8rem; color:#777; margin-top:6px;}
    .views svg {width:16px; height:16px; opacity:0.4;}

    /* Reaction Bar */
    .reaction-bar {
      display:flex; justify-content:space-between; align-items:center;
      margin-top:10px; padding-top:8px; border-top:1px solid #eee;
    }
    .reaction {
      display:inline-flex; align-items:center; gap:3px; cursor:pointer;
      font-size:1.3rem; color:#888; transition:transform 0.2s ease, color 0.2s ease; user-select:none;
    }
    .reaction.active {color:#ff1744; animation:bounce 0.3s ease;}
    .reaction .count {font-size:0.85rem; color:#333; font-weight:500;}
    @keyframes bounce {0%{transform:scale(1);}30%{transform:scale(1.3);}60%{transform:scale(0.9);}100%{transform:scale(1);} }

    /* Share Modal */
    .share-modal {
      position:fixed; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.5); backdrop-filter:blur(8px);
      display:none; justify-content:center; align-items:center; z-index:999;
    }
    .share-box {
      background:linear-gradient(135deg,#833ab4,#fd1d1d,#fcb045);
      padding:20px; border-radius:18px; color:#fff; text-align:center;
      width:280px; animation:pop 0.3s ease;
    }
    @keyframes pop {0%{transform:scale(0.8);opacity:0;}100%{transform:scale(1);opacity:1);} }
    .share-icons {display:flex; justify-content:space-around; margin-top:12px;}
    .share-icons img {
      width:42px; height:42px; background:#fff; border-radius:50%; padding:5px;
      cursor:pointer; transition:transform 0.2s ease;
    }
    .share-icons img:hover {transform:scale(1.2);}
    .copy-link {
      background:#fff; color:#333; margin-top:12px; padding:6px 10px;
      border-radius:8px; cursor:pointer; font-size:0.85rem;
    }

    /* Instagram Share Icon */
    .share-icon img {width:22px; height:22px;}
  </style>
</head>
<body>

<!-- Student Success Stories Section -->
<div class="success-stories">
  <h2>üåü Student Success Stories</h2>
  <div class="success-box">

    <!-- Card 1 -->
    <div class="success-card" data-post-id="1">
      <p>"Main PDSU ki website se judkar apni journey ko ek nayi disha mein le gaya hoon..."</p>
      <span class="name">- Ravi Sharma</span>

      <div class="views">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 5c-7 0-11 7-11 7s4 7 11 7 11-7 11-7-4-7-11-7zm0 11a4 4 0 110-8 4 4 0 010 8z"/></svg>
        <span class="view-count">0</span> views
      </div>

      <div class="reaction-bar">
        <span class="reaction" data-type="like">‚ù§Ô∏è <span class="count">0</span></span>
        <span class="reaction" data-type="thumb">üëç <span class="count">0</span></span>
        <span class="reaction" data-type="dislike">üëé <span class="count">0</span></span>
        <span class="reaction share-icon" onclick="openShare()">
          <img src="https://cdn-icons-png.flaticon.com/512/739/739257.png" alt="Share">
        </span>
      </div>
    </div>

    <!-- Card 2 -->
    <div class="success-card" data-post-id="2">
      <p>"Website ki wajah se mujhe apne exams ke liye best material mila, aur confidence bhi!"</p>
      <span class="name">- Anjali Verma</span>

      <div class="views">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 5c-7 0-11 7-11 7s4 7 11 7 11-7 11-7-4-7-11-7zm0 11a4 4 0 110-8 4 4 0 010 8z"/></svg>
        <span class="view-count">0</span> views
      </div>

      <div class="reaction-bar">
        <span class="reaction" data-type="like">‚ù§Ô∏è <span class="count">0</span></span>
        <span class="reaction" data-type="thumb">üëç <span class="count">0</span></span>
        <span class="reaction" data-type="dislike">üëé <span class="count">0</span></span>
        <span class="reaction share-icon" onclick="openShare()">
          <img src="https://cdn-icons-png.flaticon.com/512/739/739257.png" alt="Share">
        </span>
      </div>
    </div>

    <!-- Card 3 -->
    <div class="success-card" data-post-id="3">
      <p>"Itne easy aur premium design ke sath padhai karna ek alag hi maza hai!"</p>
      <span class="name">- Kunal Singh</span>

      <div class="views">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 5c-7 0-11 7-11 7s4 7 11 7 11-7 11-7-4-7-11-7zm0 11a4 4 0 110-8 4 4 0 010 8z"/></svg>
        <span class="view-count">0</span> views
      </div>

      <div class="reaction-bar">
        <span class="reaction" data-type="like">‚ù§Ô∏è <span class="count">0</span></span>
        <span class="reaction" data-type="thumb">üëç <span class="count">0</span></span>
        <span class="reaction" data-type="dislike">üëé <span class="count">0</span></span>
        <span class="reaction share-icon" onclick="openShare()">
          <img src="https://cdn-icons-png.flaticon.com/512/739/739257.png" alt="Share">
        </span>
      </div>
    </div>

  </div>
</div>

<!-- Share Modal -->
<div class="share-modal" id="shareModal">
  <div class="share-box">
    <h3>Share this Story</h3>
    <div class="share-icons">
      <img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png" onclick="shareTo('instagram')">
      <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" onclick="shareTo('whatsapp')">
      <img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" onclick="shareTo('telegram')">
    </div>
    <div class="copy-link" onclick="copyLink()"> Copy Link</div>
  </div>
</div>

<script>
let pageURL = "https://gyaankendra.github.io/gyanhai/";

// ? View count localStorage (backup)
document.querySelectorAll('.success-card').forEach(card=>{
  let id = card.dataset.postId;
  let key = "views_"+id;
  let current = localStorage.getItem(key) || 0;
  current++;
  localStorage.setItem(key,current);
  card.querySelector('.view-count').textContent = current;
});

// ? Reaction Toggle (max 2 active)
document.querySelectorAll('.reaction').forEach(btn=>{
  btn.addEventListener('click',()=>{
    if(btn.classList.contains('share-icon')) return;
    let card = btn.closest('.success-card');
    let active = card.querySelectorAll('.reaction.active');
    if(btn.classList.contains('active')){
      btn.classList.remove('active');
      let c = btn.querySelector('.count');
      c.textContent = parseInt(c.textContent)-1;
    } else {
      if(active.length>=2){
        active[0].classList.remove('active');
        let c = active[0].querySelector('.count');
        c.textContent = parseInt(c.textContent)-1;
      }
      btn.classList.add('active');
      let c = btn.querySelector('.count');
      c.textContent = parseInt(c.textContent)+1;
    }
  });
});

// ? Share modal
function openShare(){document.getElementById('shareModal').style.display='flex';}
document.getElementById('shareModal').addEventListener('click',e=>{
  if(e.target.id==='shareModal') e.target.style.display='none';
});

function copyLink(){
  navigator.clipboard.writeText(pageURL);
  alert("Link Copied!");
}

function shareTo(platform){
  let encoded = encodeURIComponent(pageURL);
  if(platform==='whatsapp'){
    window.location.href = `whatsapp://send?text=${encoded}`;
    setTimeout(()=>{window.open(`https://wa.me/?text=${encoded}`,'_blank');},1500);
  } else if(platform==='instagram'){
    window.location.href = `instagram://share?text=${encoded}`;
    setTimeout(()=>{window.open(`https://www.instagram.com/?url=${encoded}`,'_blank');},1500);
  } else if(platform==='telegram'){
    window.location.href = `tg://msg_url?url=${encoded}`;
    setTimeout(()=>{window.open(`https://t.me/share/url?url=${encoded}`,'_blank');},1500);
  }
}
</script>

<!-- ‚úÖ Firebase Realtime Database Integration -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
<script>
 const firebaseConfig = {
  apiKey: "AIzaSyDnydPhUmns376_QXo7CInsSWL7kXO8chU",
  authDomain: "reactionapp-25924.firebaseapp.com",
  databaseURL: "https://reactionapp-25924-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "reactionapp-25924",
  storageBucket: "reactionapp-25924.firebasestorage.app",
  messagingSenderId: "1048361753014",
  appId: "1:1048361753014:web:14015b761a9481ec460917"
};
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // ‚úÖ Views Sync
  document.querySelectorAll('.success-card').forEach(card=>{
    let id = card.dataset.postId;
    let ref = db.ref('views/'+id);
    ref.transaction(count => (count||0)+1);
    ref.on('value', snap=>{
      card.querySelector('.view-count').textContent = snap.val() || 0;
    });
  });

  // ‚úÖ Reaction Sync
  document.querySelectorAll('.reaction').forEach(btn=>{
    btn.addEventListener('click',()=>{
      if(btn.classList.contains('share-icon')) return;
      let card = btn.closest('.success-card');
      let id = card.dataset.postId;
      let type = btn.dataset.type;
      let ref = db.ref('reactions/'+id+'/'+type);

      if(btn.classList.contains('active')){
        ref.transaction(count => Math.max((count||0)-1,0));
      } else {
        let active = card.querySelectorAll('.reaction.active');
        if(active.length>=2){
          let old = active[0];
          old.classList.remove('active');
          let oldType = old.dataset.type;
          db.ref('reactions/'+id+'/'+oldType).transaction(count => Math.max((count||0)-1,0));
        }
        ref.transaction(count => (count||0)+1);
      }
    });
  });

  // ‚úÖ Live Count Listener
  document.querySelectorAll('.success-card').forEach(card=>{
    let id = card.dataset.postId;
    ['like','thumb','dislike'].forEach(type=>{
      let ref = db.ref('reactions/'+id+'/'+type);
      let el = card.querySelector(`.reaction[data-type="${type}"] .count`);
      ref.on('value', snap=>{
        el.textContent = snap.val() || 0;
      });
    });
  });
</script>

</body>
</html>
